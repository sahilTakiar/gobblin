<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="author" content="Abhishek Tiwari, Chavdar Botev, Issac Buenrostro, Min Tu, Narasimha Veeramreedy, Pradhan Cadabam, Sahil Takiar, Shirshanka Das, Yinan Li, Ying Dai, Ziyang Liu">
  
  <title>Implementing New Reporters - Gobblin Documentation</title>
  

  <link rel="shortcut icon" href="../../img/favicon.ico">

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../css/highlight.css">
  <link href="../../css/extra.css" rel="stylesheet">

  
  <script>
    // Current page data
    var mkdocs_page_name = "Implementing New Reporters";
    var mkdocs_page_input_path = "metrics/Implementing-New-Reporters.md";
    var mkdocs_page_url = "/metrics/Implementing-New-Reporters/";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js"></script>
  <script src="../../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../../js/highlight.pack.js"></script>
  <script src="../../js/theme.js"></script> 

  
  <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-74333035-1', 'gobblin.readthedocs.org');
      ga('send', 'pageview');
  </script>
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> Gobblin Documentation</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        <ul class="current">
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../..">Home</a>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../../Getting-Started/">Getting Started</a>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../../Gobblin-Architecture/">Architecture</a>
        
    </li>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>User Guide</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../user-guide/Working-with-Job-Configuration-Files/">Job Configuration Files</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../user-guide/Gobblin-Deployment/">Deployment</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../user-guide/Gobblin-on-Yarn/">Gobblin on Yarn</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../user-guide/Compaction/">Compaction</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../user-guide/State-Management-and-Watermarks/">State Management and Watermarks</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../user-guide/Working-with-the-ForkOperator/">Fork Operator</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../user-guide/Configuration-Properties-Glossary/">Configuration Glossary</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../user-guide/Partitioned-Writers/">Partitioned Writers</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../user-guide/Monitoring/">Monitoring</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../user-guide/Gobblin-Schedulers/">Schedulers</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../user-guide/Job-Execution-History-Store/">Job Execution History Store</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../user-guide/Gobblin-Build-Options/">Gobblin Build Options</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../user-guide/Troubleshooting/">Troubleshooting</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../user-guide/FAQs/">FAQs</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Case Studies</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../case-studies/Kafka-HDFS-Ingestion/">Kafka-HDFS Ingestion</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../case-studies/Publishing-Data-to-S3/">Publishing Data to S3</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Gobblin Metrics</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Gobblin-Metrics/">Quick Start</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Existing-Reporters/">Existing Reporters</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Metrics-for-Gobblin-ETL/">Metrics for Gobblin ETL</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Gobblin-Metrics-Architecture/">Gobblin Metrics Architecture</a>
        
    </li>

        
            
    <li class="toctree-l1 current">
        <a class="current" href="./">Implementing New Reporters</a>
        
            <ul>
            
                <li class="toctree-l3"><a href="#table-of-contents">Table of Contents</a></li>
                
            
                <li class="toctree-l3"><a href="#extending-builders">Extending Builders</a></li>
                
            
                <li class="toctree-l3"><a href="#metric-reporting">Metric Reporting</a></li>
                
            
                <li class="toctree-l3"><a href="#event-reporting">Event Reporting</a></li>
                
            
                <li class="toctree-l3"><a href="#other-reporters">Other Reporters</a></li>
                
            
            </ul>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Gobblin-Metrics-Performance/">Gobblin Metrics Performance</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Developer Guide</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../developer-guide/Customization-for-New-Source/">Customization for New Source</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../developer-guide/Customization-for-Converter-and-Operator/">Customization for Converter and Operator</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../developer-guide/CodingStyle/">Code Style Guide</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../developer-guide/IDE-setup/">IDE setup</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../developer-guide/Monitoring-Design/">Monitoring Design</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Project</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../project/Feature-List/">Feature List</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../project/Team/">Contributors and Team</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../project/Talks-and-Tech-Blogs/">Talks and Tech Blog Posts</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../project/News/">News and Roadmap</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../project/Posts/">Posts</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Miscellaneous</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../miscellaneous/Camus-to-Gobblin-Migration/">Camus to Gobblin Migration</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../miscellaneous/Exactly-Once-Support/">Exactly Once Support</a>
        
    </li>

        
    </ul>
<li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">Gobblin Documentation</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Gobblin Metrics &raquo;</li>
        
      
    
    <li>Implementing New Reporters</li>
    <li class="wy-breadcrumbs-aside">
      
        
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h2 id="table-of-contents">Table of Contents<a class="headerlink" href="#table-of-contents" title="Permanent link">&para;</a></h2>
<div class="toc">
<ul>
<li><a href="#table-of-contents">Table of Contents</a></li>
<li><a href="#extending-builders">Extending Builders</a></li>
<li><a href="#metric-reporting">Metric Reporting</a></li>
<li><a href="#event-reporting">Event Reporting</a></li>
<li><a href="#other-reporters">Other Reporters</a></li>
</ul>
</div>
<p>The two best entry points for implementing custom reporters are <a href="https://github.com/linkedin/gobblin/blob/master/gobblin-metrics/src/main/java/gobblin/metrics/reporter/RecursiveScheduledMetricReporter.java">RecursiveScheduledMetricReporter</a> and <a href="https://github.com/linkedin/gobblin/blob/master/gobblin-metrics/src/main/java/gobblin/metrics/reporter/EventReporter.java">EventReporter</a>. Each of these classes automatically schedules reporting, extracts the correct metrics, and calls a single method that must be implemented by the developer. These methods also implement builder patterns that can be extended by the developer.</p>
<p>In the interest of giving more control to the users, metric and event reporters are kept separate, allowing users to more easily specify separate sinks for events and metrics. However, it is possible to implement a single report that handles both events and metrics.</p>
<blockquote>
<p>It is recommended that each reporter has a constructor with signature <code>&lt;init&gt;(Properties)</code>. In the near future we are planning to implement auto-starting, file-configurable reporting similar to Log4j architecture, and compliant reporters will be required to have such a constructor.</p>
</blockquote>
<h1 id="extending-builders">Extending Builders<a class="headerlink" href="#extending-builders" title="Permanent link">&para;</a></h1>
<p>The builder patterns implemented in the base reporters are designed to be extendable. The architecture is a bit complicated, but a subclass of the base reporters wanting to use builder patterns should follow this pattern (replacing with RecursiveScheduledMetricReporter in the case of a metrics reporter):</p>
<pre><code class="java">class MyReporter extends EventReporter {

  private MyReporter(Builder&lt;?&gt; builder) throws IOException {
    super(builder);
    // Other initialization logic.
  }

  // Concrete implementation of extendable Builder.
  public static class BuilderImpl extends Builder&lt;BuilderImpl&gt; {
    private BuilderImpl(MetricContext context) {
      super(context);
    }

    @Override
    protected BuilderImpl self() {
      return this;
    }
  }

  public static class Factory {
    /**
     * Returns a new {@link MyReporter.Builder} for {@link MyReporter}.
     * Will automatically add all Context tags to the reporter.
     *
     * @param context the {@link gobblin.metrics.MetricContext} to report
     * @return MyReporter builder
     */
    public static BuilderImpl forContext(MetricContext context) {
      return new BuilderImpl(context);
    }
  }

  /**
   * Builder for {@link MyReporter}.
   */
  public static abstract class Builder&lt;T extends EventReporter.Builder&lt;T&gt;&gt;
      extends EventReporter.Builder&lt;T&gt; {

    // Additional instance variables needed to construct MyReporter.
    private int myBuilderVariable;

    protected Builder(MetricContext context) {
      super(context);
      this.myBuilderVariable = 0;
    }

    /**
     * Set myBuilderVariable.
     */
    public T withMyBuilderVariable(int value) {
      this.myBuilderVariable = value;
      return self();
    }

    // Other setters for Builder variables.

    /**
     * Builds and returns {@link MyReporter}.
     */
    public MyReporter build() throws IOException {
      return new MyReporter(this);
    }

  }
}
</code></pre>

<p>This pattern allows users to simply call</p>
<pre><code class="java">MyReporter reporter = MyReporter.Factory.forContext(context).build();
</code></pre>

<p>to generate an instance of the reporter. Additionally, if you want to further extend MyReporter, following the exact same pattern except extending MyReporter instead of EventReporter will work correctly (which would not be true with standard Builder pattern).</p>
<h1 id="metric-reporting">Metric Reporting<a class="headerlink" href="#metric-reporting" title="Permanent link">&para;</a></h1>
<p>Developers should extend <code>RecursiveScheduledMetricReporter</code> and implement the method <code>RecursiveScheduledMetricReporter#report</code>. The base class will call report when appropriate with the list of metrics, separated by type, and tags that should be reported.</p>
<h1 id="event-reporting">Event Reporting<a class="headerlink" href="#event-reporting" title="Permanent link">&para;</a></h1>
<p>Developers should extend <code>EventReporter</code> and implement the method <code>EventReporter#reportEventQueue(Queue&lt;GobblinTrackingEvent&gt;)</code>. The base class will call this method with a queue of all events to report as needed.</p>
<h1 id="other-reporters">Other Reporters<a class="headerlink" href="#other-reporters" title="Permanent link">&para;</a></h1>
<p>It is also possible to implement a reporter without using the suggested classes. Reporters are recommended, but not required, to extend the interface <code>Reporter</code>. Reporters can use the public methods of <code>MetricContext</code> to navigate the Metric Context tree, query metrics, and register for notifications.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../Gobblin-Metrics-Performance/" class="btn btn-neutral float-right" title="Gobblin Metrics Performance">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../Gobblin-Metrics-Architecture/" class="btn btn-neutral" title="Gobblin Metrics Architecture"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>

  </div>

<div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../Gobblin-Metrics-Architecture/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../Gobblin-Metrics-Performance/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>

</body>
</html>
